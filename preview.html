<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Postis Driver App - Preview</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap');

        body {
            font-family: 'Inter', sans-serif;
        }

        .pt-safe {
            padding-top: env(safe-area-inset-top);
        }
    </style>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: {
                            50: '#f0f9ff', 100: '#e0f2fe', 200: '#bae6fd', 300: '#7dd3fc',
                            400: '#38bdf8', 500: '#0ea5e9', 600: '#0284c7', 700: '#0369a1',
                            800: '#075985', 900: '#0c4a6e',
                        },
                    },
                },
            },
        }
    </script>
</head>

<body class="bg-gray-50 dark:bg-gray-900 min-h-screen flex flex-col items-center">
    <div id="root"
        class="w-full max-w-[500px] min-h-screen bg-white dark:bg-gray-800 shadow-xl overflow-hidden shadow-2xl"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // Mock Icons mapping for ease of use in single file
        const Icon = ({ name, size = 24, className = "" }) => {
            return <i data-lucide={name} style={{ width: size, height: size }} className={className}></i>;
        };

        const LoginPage = ({ onLogin }) => {
            return (
                <div className="min-h-screen flex flex-col items-center justify-center p-8 bg-white dark:bg-gray-900">
                    <div className="w-full space-y-12">
                        <div className="flex flex-col items-center">
                            <div className="w-24 h-24 mb-6 shadow-2xl rounded-3xl overflow-hidden ring-4 ring-primary-50">
                                <img src="/icon-512.png" alt="AWB System" className="w-full h-full object-contain" />
                            </div>
                            <h1 className="text-3xl font-black text-gray-900 dark:text-white mb-2">AWB System</h1>
                            <p className="text-gray-500 font-medium tracking-tight">Postis Integrated Logistics</p>
                        </div>
                        <div className="space-y-4">
                            <div className="space-y-2">
                                <label className="text-[10px] font-black uppercase tracking-widest text-gray-400 ml-2">Access Portal</label>
                                <input type="text" placeholder="Username" className="w-full p-5 rounded-[24px] bg-gray-50 dark:bg-gray-800 border-2 border-transparent focus:border-primary-500 outline-none shadow-sm transition-all font-bold" value="driver_alpha" readOnly />
                                <input type="password" placeholder="Password" className="w-full p-5 rounded-[24px] bg-gray-50 dark:bg-gray-800 border-2 border-transparent focus:border-primary-500 outline-none shadow-sm transition-all font-bold" value="••••••••" readOnly />
                            </div>
                            <button onClick={onLogin} className="w-full p-5 bg-primary-600 hover:bg-primary-700 text-white rounded-[24px] font-black text-lg shadow-2xl shadow-primary-500/40 transition-all active:scale-95 uppercase tracking-widest">
                                Sign In
                            </button>
                        </div>
                    </div>
                </div>
            );
        };

        const HomePage = ({ onScan, setView }) => {
            return (
                <div className="min-h-screen flex flex-col pt-safe px-6 pb-6 bg-gray-50 dark:bg-gray-900">
                    <header className="py-8 flex justify-between items-center bg-gradient-to-b from-white to-transparent dark:from-gray-900">
                        <div className="flex items-center gap-3">
                            <img src="/logo-horizontal.png" alt="AWB System" className="h-10 object-contain" />
                            <div className="flex items-center gap-1 text-[10px] text-green-500 font-extrabold uppercase tracking-widest bg-green-50 dark:bg-green-900/20 px-2 py-0.5 rounded-full">
                                <div className="w-1.5 h-1.5 rounded-full bg-green-500 animate-pulse"></div>
                                Live
                            </div>
                        </div>
                        <div className="p-3 bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-gray-100 dark:border-gray-700">
                            <Icon name="smartphone" className="text-gray-400" />
                        </div>
                    </header>

                    <div className="flex-1 space-y-6">
                        <button onClick={onScan} className="w-full h-48 bg-primary-600 rounded-[40px] shadow-2xl shadow-primary-500/40 flex flex-col items-center justify-center text-white space-y-4 active:scale-95 transition-all">
                            <div className="p-4 bg-white/20 rounded-full">
                                <Icon name="scan" size={48} />
                            </div>
                            <div className="text-center">
                                <h2 className="text-xl font-bold">New Scan</h2>
                                <p className="text-primary-100 text-sm">Scan Barcode / AWB</p>
                            </div>
                        </button>

                        <button onClick={() => setView('shipments')} className="w-full p-6 bg-white dark:bg-gray-800 rounded-3xl shadow-sm border border-gray-100 dark:border-gray-700 flex items-center gap-4 active:scale-95 transition-all">
                            <div className="p-3 bg-blue-50 text-blue-500 rounded-xl">
                                <Icon name="search" size={24} />
                            </div>
                            <div className="flex-1 text-left">
                                <h3 className="font-bold text-gray-900 dark:text-white">Search Shipments</h3>
                                <p className="text-xs text-gray-500">View real-time list</p>
                            </div>
                            <Icon name="chevron-right" className="text-gray-300" />
                        </button>

                        <div className="grid grid-cols-2 gap-4">
                            <div className="p-6 bg-primary-50 dark:bg-primary-900/10 rounded-3xl border border-primary-100 dark:border-primary-800">
                                <Icon name="package" className="text-primary-600 mb-2" />
                                <h3 className="font-bold text-gray-900 dark:text-white">Active</h3>
                                <p className="text-2xl font-black text-primary-600">12</p>
                            </div>
                            <div className="p-6 bg-green-50 dark:bg-green-900/10 rounded-3xl border border-green-100 dark:border-green-800">
                                <Icon name="check-circle" className="text-green-600 mb-2" />
                                <h3 className="font-bold text-gray-900 dark:text-white">Done</h3>
                                <p className="text-2xl font-black text-green-600">48</p>
                            </div>
                        </div>
                    </div>

                    <nav className="flex justify-around items-center p-4 bg-white dark:bg-gray-800 rounded-3xl shadow-lg border border-gray-100 dark:border-gray-700 mt-6">
                        <Icon name="home" className="text-primary-600" />
                        <Icon name="history" className="text-gray-400" />
                        <Icon name="settings" className="text-gray-400" />
                    </nav>
                </div>
            );
        };

        const ScannerPage = ({ onComplete, onCancel }) => {
            const [awb, setAwb] = useState("");
            return (
                <div className="min-h-screen bg-black flex flex-col relative">
                    <div className="absolute inset-0 opacity-40 bg-[url('https://images.unsplash.com/photo-1586528116311-ad8dd3c8310d?auto=format&fit=crop&q=80&w=1000')] bg-cover"></div>
                    <div className="z-10 flex flex-col h-full pt-safe px-6 pb-12">
                        <div className="flex justify-between items-center py-6 text-white">
                            <h2 className="text-xl font-bold">Scanning...</h2>
                            <button onClick={onCancel} className="p-2"><Icon name="x" /></button>
                        </div>
                        <div className="flex-1 flex flex-col items-center justify-center">
                            <div className="w-64 h-64 border-2 border-primary-500 rounded-3xl relative">
                                <div className="absolute inset-0 bg-primary-500/10 animate-pulse"></div>
                                <div className="absolute top-1/2 left-0 right-0 h-0.5 bg-primary-500 shadow-[0_0_15px_rgba(14,165,233,0.8)] animate-bounce"></div>
                            </div>
                            <p className="mt-8 text-white/60 font-medium">Align barcode within frame</p>
                        </div>
                        <div className="space-y-4">
                            <input
                                className="w-full p-4 rounded-2xl bg-white/10 backdrop-blur-md border border-white/20 text-white text-center text-xl font-bold tracking-[0.2em] outline-none"
                                placeholder="MANUAL ENTRY"
                                value={awb}
                                onChange={(e) => setAwb(e.target.value.toUpperCase())}
                            />
                            <button
                                onClick={() => onComplete(awb || "AWB12345678")}
                                className="w-full p-4 bg-white text-black rounded-2xl font-extrabold active:scale-95 transition-all"
                            >
                                Process Shipment
                            </button>
                        </div>
                    </div>
                </div>
            );
        };

        const StatusPage = ({ awb, onFinish, onBack }) => {
            const statuses = [
                { id: 'DELIVERED', label: 'Delivered', icon: 'check-circle', color: 'text-green-600' },
                { id: 'NOT_HOME', label: 'Not at Home', icon: 'home', color: 'text-orange-500' },
                { id: 'REFUSED', label: 'Refused', icon: 'x-circle', color: 'text-red-600' },
                { id: 'WRONG_ADDR', label: 'Address Error', icon: 'map', color: 'text-gray-500' },
            ];
            return (
                <div className="min-h-screen bg-gray-50 dark:bg-gray-900 flex flex-col pt-safe">
                    <div className="p-6 flex items-center gap-4 bg-white dark:bg-gray-800 shadow-sm">
                        <button onClick={onBack}><Icon name="arrow-left" className="text-gray-600" /></button>
                        <div>
                            <h1 className="font-bold text-gray-900 dark:text-white">Shipment Update</h1>
                            <p className="font-mono text-xs text-primary-600 tracking-widest">{awb}</p>
                        </div>
                    </div>
                    <div className="flex-1 p-6 space-y-4">
                        {statuses.map(s => (
                            <button key={s.id} onClick={onFinish} className="w-full p-5 bg-white dark:bg-gray-800 rounded-3xl flex items-center gap-4 shadow-sm border-2 border-transparent active:border-primary-500 transition-all">
                                <div className={`p-3 bg-gray-50 dark:bg-gray-700 rounded-2xl ${s.color}`}>
                                    <Icon name={s.icon} size={24} />
                                </div>
                                <span className="text-lg font-bold text-gray-900 dark:text-white">{s.label}</span>
                                <Icon name="chevron-right" className="ml-auto text-gray-300" />
                            </button>
                        ))}
                    </div>
                    <div className="p-6">
                        <button className="w-full p-4 bg-gray-200 dark:bg-gray-700 text-gray-500 rounded-2xl font-bold opacity-50 cursor-not-allowed">
                            Submit Update
                        </button>
                    </div>
                </div>
            );
        };

        const ShipmentsView = ({ onBack }) => {
            const [expanded, setExpanded] = useState(null);
            const data = [
                {
                    awb: '298374928374',
                    name: 'John Doe',
                    addr: 'Bucharest, Sector 3, Blvd Unirii 10',
                    status: 'In depozit',
                    weight: 2.5,
                    history: [
                        { eventDescription: 'Primit in depozit', eventDate: '2026-02-12 08:30', localityName: 'Bucuresti' },
                        { eventDescription: 'Preluat de la expeditor', eventDate: '2026-02-11 16:45', localityName: 'Ploiesti' }
                    ]
                },
                {
                    awb: '102938475654',
                    name: 'Alina Popa',
                    addr: 'Cluj-Napoca, Centru, Str. Eroilor 2',
                    status: 'Livrat',
                    weight: 0.8,
                    history: [
                        { eventDescription: 'Livrat cu succes', eventDate: '2026-02-12 14:20', localityName: 'Cluj-Napoca' },
                        { eventDescription: 'In curs de livrare', eventDate: '2026-02-12 09:15', localityName: 'Cluj-Napoca' }
                    ]
                },
                {
                    awb: '556677889900',
                    name: 'Mihai Ionescu',
                    addr: 'Iasi, Piata Unirii 5',
                    status: 'In tranzit',
                    weight: 15.2,
                    history: [
                        { eventDescription: 'In tranzit spre hub', eventDate: '2026-02-12 11:00', localityName: 'Brasov' }
                    ]
                },
            ];
            return (
                <div className="min-h-screen bg-gray-50 dark:bg-gray-900 flex flex-col pt-safe">
                    <div className="p-6 bg-white dark:bg-gray-800 shadow-sm flex items-center gap-4 sticky top-0 z-20">
                        <button onClick={onBack}><Icon name="arrow-left" className="text-gray-600" /></button>
                        <h1 className="text-xl font-bold text-gray-900 dark:text-white">Live Tracking</h1>
                        <button className="ml-auto p-2 text-primary-500"><Icon name="refresh-cw" size={20} /></button>
                    </div>
                    <div className="p-4 space-y-4">
                        <div className="relative mb-6">
                            <Icon name="search" className="absolute left-4 top-1/2 -translate-y-1/2 text-gray-400" size={18} />
                            <input className="w-full pl-12 pr-4 py-4 bg-white dark:bg-gray-700 rounded-[24px] outline-none shadow-sm border border-gray-100 dark:border-gray-700 focus:ring-2 focus:ring-primary-500" placeholder="Search by AWB or Name..." />
                        </div>
                        <div className="space-y-4">
                            {data.map((d, idx) => (
                                <div key={d.awb} className="bg-white dark:bg-gray-800 rounded-[32px] border border-gray-100 dark:border-gray-700 overflow-hidden shadow-sm transition-all duration-300">
                                    <div
                                        onClick={() => setExpanded(expanded === idx ? null : idx)}
                                        className="p-5 flex items-center gap-4 active:bg-gray-50 dark:active:bg-gray-700/50 cursor-pointer"
                                    >
                                        <div className="p-3 bg-primary-50 dark:bg-primary-900/20 rounded-2xl text-primary-600 font-bold"><Icon name="package" /></div>
                                        <div className="flex-1 min-w-0">
                                            <div className="flex justify-between items-center mb-1">
                                                <span className="font-mono text-xs font-bold text-gray-900 dark:text-white uppercase tracking-tighter">{d.awb}</span>
                                                <span className={`text-[10px] font-black px-2 py-0.5 rounded-full uppercase ${d.status === 'Livrat' ? 'bg-green-50 text-green-600' : 'bg-blue-50 text-blue-600'}`}>{d.status}</span>
                                            </div>
                                            <p className="text-sm text-gray-700 dark:text-gray-200 font-bold truncate">{d.name}</p>
                                            <div className="flex items-center gap-2 mt-0.5">
                                                <p className="text-[10px] text-gray-400 truncate flex-1">{d.addr}</p>
                                                <span className="text-[10px] bg-gray-100 dark:bg-gray-700 px-1.5 py-0.5 rounded text-gray-500">{d.weight}kg</span>
                                            </div>
                                        </div>
                                        <Icon name="chevron-right" className={`text-gray-300 transition-transform ${expanded === idx ? 'rotate-90' : ''}`} />
                                    </div>

                                    {expanded === idx && (
                                        <div className="px-5 pb-5 pt-2 border-t border-gray-50 dark:border-gray-700/50 bg-gray-50/20">
                                            <h4 className="text-[8px] font-black text-gray-400 uppercase tracking-widest mb-3">Timeline</h4>
                                            <div className="space-y-4 relative">
                                                <div className="absolute left-2.5 top-2 bottom-2 w-0.5 bg-gray-100 dark:bg-gray-700"></div>
                                                {d.history.map((event, eIdx) => (
                                                    <div key={eIdx} className="flex gap-4 relative">
                                                        <div className={`w-5 h-5 rounded-full border-4 border-white dark:border-gray-800 z-10 flex-shrink-0 ${eIdx === 0 ? 'bg-primary-500' : 'bg-gray-200'}`}></div>
                                                        <div className="flex-1 min-w-0">
                                                            <p className="text-[11px] font-bold text-gray-800 dark:text-gray-200">{event.eventDescription}</p>
                                                            <p className="text-[9px] text-gray-500 mt-0.5">{event.eventDate} • {event.localityName}</p>
                                                        </div>
                                                    </div>
                                                ))}
                                            </div>
                                        </div>
                                    )}
                                </div>
                            ))}
                        </div>
                    </div>
                </div>
            );
        };

        const App = () => {
            const [view, setView] = useState('login');
            const [awb, setAwb] = useState("");

            useEffect(() => {
                if (window.lucide) window.lucide.createIcons();
            }, [view]);

            if (view === 'login') return <LoginPage onLogin={() => setView('home')} />;
            if (view === 'home') return <HomePage onScan={() => setView('scanner')} setView={setView} />;
            if (view === 'scanner') return <ScannerPage onComplete={(val) => { setAwb(val); setView('status'); }} onCancel={() => setView('home')} />;
            if (view === 'status') return <StatusPage awb={awb} onFinish={() => setView('home')} onBack={() => setView('home')} />;
            if (view === 'shipments') return <ShipmentsView onBack={() => setView('home')} />;

            return <div>App View Error</div>;
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>

</html>